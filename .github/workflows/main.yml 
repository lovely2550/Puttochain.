# ... (โค้ดส่วนอื่น ๆ ของ main.yml) ...

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
    # ... (Setup Python เหมือนเดิม) ...
        
    - name: Install dependencies (FINAL FIX)
      run: |
        # ติดตั้งแพ็กเกจหลักทั้งหมดที่จำเป็นสำหรับการรัน
        pip install fastapi uvicorn[standard] pydantic web3 python-dotenv sqlalchemy psycopg2-binary
        
        # *** ติดตั้งโปรเจกต์ตัวเองในโหมดแก้ไข เพื่อให้ Pytest รู้จักโมดูล ***
        pip install -e .
        
        # ติดตั้งเครื่องมือทดสอบ
        pip install pytest pytest-cov flake8

    # ... (ขั้นตอน Lint และ Test ที่เหลือ) ...
